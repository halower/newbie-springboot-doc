# 单元测试

?> 单元测试在开发中也是非常有用的一个环节, `SpringBoot`的测试脚手架基本非常简洁的帮我们搞定了

## 怎么使用
> 只需要添加`spring-boot-starter-test`依赖到项目中

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-test</artifactId>
    <version>2.0.3.RELEASE</version>
    <scope>test</scope>
</dependency>

```
> 以之前`5分钟教程`中的示例作为演示,很简单的就完成了一个基本测试  

```
@RunWith(SpringRunner.class)
@SpringBootTest
@Transactional
public class BlogServiceTest {
    @Autowired
    private BlogAppService blogAppService;

    @Test
    public void getBlogTest() {
       blogAppService.add(new CreatedBlogInputDto("www.baidu.com"));
       var blog = blogAppService.fetchBlogs().get(0);
       assertEquals(blog.getUrl(), "www.baidu.com");
    }
}
```
执行测试后我们就可以看到测试的结构了，如果不通过则会提示不通过原因
![](_img/test.jpg)

!> `Spring`单元测试考虑到性能的原因，不会为每一个单元测试都创建一个全新的上下文，而是会缓存上下文环境，如果你有需求要重新加载上下文,需要加上在测试方法上添加`@DirtiesContext`注解。

## 场景说明
- 所有的单元测试都可以自动的进行事务回滚
- 如果需要在单元测试前准备一些数据可以使用`@Sql`注解，去加载和执行对应的初始化脚本
- 当我们需要调用第三方或者其它团队没有完成的api的时候，我们可以使用`Mockito`进行服务模拟

## 更多请阅读
[官方文档——单元测试](https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-testing.html)